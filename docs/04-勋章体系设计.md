# 勋章体系设计（v0）

目标：
- 强化荣誉感（通关、完美、坚持、复盘）
- 不挫败（失败也能得到正反馈）
- 规则可配置、可扩展、可记录

## 1. 勋章分类

### A. 关卡类（进度勋章）
- `clear_u{n}`：第 n 单元通关（≥⭐⭐）
- `star3_u{n}`：第 n 单元完美（三星）

### B. 坚持类（失败/持续挑战也奖励）
- `persistence_fails_5`：累计失败 5 次
- `persistence_fails_10`：累计失败 10 次
- `persistence_runs_20`：累计完成 20 局（无论成败）

### C. 复盘类（鼓励纠错）
- `review_mistakes_10`：累计复盘错题 10 次
- `review_streak_3d`：连续 3 天完成复盘（v1）

### D. 探索类（鼓励多关卡复习）
- `explorer_3_units`：至少挑战过 3 个单元
- `explorer_all_units`：8 个单元都挑战过

## 2. 触发事件（Event-driven）
MVP 可先从以下事件开始：
- `RUN_FINISHED`：一局结束（包含 score、stars、passed、unitId）
- `RUN_FAILED`：一局未达通关（stars < 2）
- `UNIT_CLEARED`：首次达到通关
- `UNIT_STAR3`：首次达到三星

## 3. 规则引擎建议（工程实现方向）
- 输入：用户聚合状态（各关 best/attempts/fails、总失败、总 run、复盘次数…） + 本次事件
- 输出：应授予的 badgeId 列表
- 去重：同一 badge 只授予一次（DB unique(user, badgeId)）

## 4. Unit1（示例）
- 达到 ⭐⭐：授予 `clear_u1`
- 达到 ⭐⭐⭐：授予 `star3_u1`
- 总失败达到 5：授予 `persistence_fails_5`

## 5. 与 Banana Pro 资源联动规范
- badgeId 必须稳定（作为文件名/数据库 key）
- 导出文件命名：`badge-{badgeId}.png`
- 建议尺寸：256x256（透明背景）

## 6. 文案原则（儿童友好）
- 坚持类勋章必须是正向表达："坚持不懈"、"勇敢挑战"、"越挫越勇"
- 错误反馈避免惩罚性语言，改为引导："再试一次"、"差一点点"、"已经进步了"
